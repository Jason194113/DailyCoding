<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="SSM.Dao.UserMapper">
    <select id="selectUser" parameterType="String" resultMap="UserMapper">
        select * from username where username=#{name}
    </select>
    <resultMap id="UserMapper" type="SSM.Bean.User">
        <result column="username" property="username"/>
        <result column="password" property="password"/>
    </resultMap>
    <select id="selectUserWithRole" parameterType="String" resultMap="Role">
       SELECT * FROM `username`,user_role,roles WHERE
username.id=user_role.user_id AND user_role.role_id=roles.id AND username=#{name}
    </select>
    <resultMap id="Role" type="SSM.Bean.User">
        <result column="username" property="username"/>
        <result column="password" property="password"/>
      <association property="role" javaType="SSM.Bean.Role">
          <result property="id" column="role_id"/>
          <result property="name" column="name"/>
      </association>
    </resultMap>
<insert id="insertUser" parameterType="SSM.Bean.User">
    insert into tbl_login(username,password) value(#{username},#{password})
</insert>
    <select id="selectPermission" parameterType="int" resultMap="Permission">
   SELECT * FROM role_permission,permissions WHERE
    role_permission.role_id=#{id} AND role_permission.permission_id=permissions.id
    </select>
    <resultMap id="Permission" type="SSM.Bean.Role">
        <result property="id" column="role_id"/>
        <collection property="userPermissions" ofType="SSM.Bean.UserPermission">
            <result column="resource" property="userpermission"/>
        </collection>
    </resultMap>
</mapper>